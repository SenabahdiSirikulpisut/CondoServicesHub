<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Condo Services Hub</title>
<style>
body { font-family:sans-serif; background:#f9f9f9; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; }
#hub { position:relative; width:400px; height:400px; }
#center-node { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); width:120px; height:120px; border-radius:50%; background:#ffcc00; display:flex; justify-content:center; align-items:center; cursor:pointer; font-size:1.2rem; text-align:center; box-shadow:0 6px 12px rgba(0,0,0,0.3); }
.node { position:absolute; width:70px; height:70px; border-radius:50%; background:#00ccff; display:flex; justify-content:center; align-items:center; cursor:pointer; font-size:1.5rem; box-shadow:0 4px 8px rgba(0,0,0,0.2); transition: transform 0.2s; }
.node:hover { transform:scale(1.1); box-shadow:0 6px 12px rgba(0,0,0,0.3); }
#popup { position:fixed; top:50%; left:50%; transform:translate(-50%,-50%); background:white; padding:20px; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.2); max-width:300px; text-align:center; display:none; z-index:1000; }
#popup a { display:block; margin-top:10px; text-decoration:none; background:#00ccff; color:white; padding:8px 12px; border-radius:5px; }
#popup button { margin-top:10px; padding:5px 10px; border:none; border-radius:5px; background:#ccc; cursor:pointer; }
</style>
</head>
<body>

<div id="hub">
  <div id="center-node">üè¢ Condo Services</div>
  <div id="nodes-container"></div>
</div>

<div id="popup">
  <div id="popup-content"></div>
  <button onclick="closePopup()">Close</button>
</div>

<script>
// Center coordinates & radius
const container = document.getElementById("nodes-container");
const popup = document.getElementById("popup");
const popupContent = document.getElementById("popup-content");
const centerX = 200;
const centerY = 200;
const radius = 150;

// Function called by JSONP
function handleServices(services) {
  const angleStep = (2 * Math.PI) / services.length;

  services.forEach((service, index) => {
    const angle = index * angleStep;
    const x = centerX + radius * Math.cos(angle) - 35;
    const y = centerY + radius * Math.sin(angle) - 35;

    const node = document.createElement("div");
    node.className = "node";
    node.style.left = x + "px";
    node.style.top = y + "px";
    node.innerHTML = service.icon;

    node.onclick = () => {
      popupContent.innerHTML = `
        <h3>${service.name}</h3>
        <p>${service.instructions}</p>
        <a href="${service.link}" target="_blank">
          ${service.type === "direct" ? "Go to Service" : "Open App"}
        </a>`;
      popup.style.display = "block";
    };

    container.appendChild(node);
  });
}

function closePopup() { popup.style.display = "none"; }

// Load the backend JSONP
const script = document.createElement("script");
script.src = "https://script.google.com/macros/s/AKfycbxiv6ZNa9CvwBrB2CftM-0EqHhq6QynVy8malNf--1AkgAaO9d1qFqG7qVTfzsS2PYI/exec?callback=handleServices";
document.body.appendChild(script);
</script>

</body>
</html>
